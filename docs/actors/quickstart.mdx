---
title: Node.js & Bun
icon: node-js
---

<Steps>
<Step title="Install">

```sh
npm install @rivetkit/actor
```

</Step>
<Step title="Write Actor">

```ts registry.ts
import { actor, setup } from "@rivetkit/actor";

export const counter = actor({
	state: { count: 0 },
	actions: {
		increment: (c, x: number) => {
			c.state.count += x;
			return c.state.count;
		},
	},
});

export const registry = setup({
	use: { counter },
});
```

</Step>


<Step title="Setup server">

<CodeGroup>

```ts Hono
import { registry } from "./registry";
import { Hono } from "hono";

// Start RivetKit
//
// State is stored in memory, this can be configured later
const { client, serve } = registry.server();

// Setup server
const app = new Hono();

// Example endpoint
app.post("/increment/:name", async (c) => {
	const name = c.req.param("name");

	// Communicate with actor
	const counter = client.counter.getOrCreate(name);
	const newCount = await counter.increment(1);

	return c.text(`New Count: ${newCount}`);
});

// Start server
serve(app);
```


```ts Express.js
TODO
```

```ts Elysia.js
TODO
```

TODO: How to serve without registry helper

TODO: Why we need to use our own custom serve fn

</CodeGroup>

<Info>
	TODO: Exporting `registry` and `app.fetch` (as `default`) is important.
</Info>

_If you want to run without export fetch (i.e. standalone Node.js), see below._

</Step>

<Step title="Run server">

<CodeGroup>

```sh Node.js
npx tsx --watch src/server.ts
```

```sh Bun
bun run --watch src/server.ts
```

</CodeGroup>

</Step>

<Step title="Connect to backend">

<CodeGroup>

```ts fetch
const res = await fetch("http://localhost:8080/increment/foo", {
	method: "POST"
});
console.log("Output:", await res.text());
```

```sh curl
curl -X POST localhost:8080/increment/foo
```

</CodeGroup>


</Step>

<Step title="Deploy">

<Tabs>

<Tab title="Rivet">

```json rivet.json
{
  "rivetkit": {
    "registry": "src/registry.ts",
    "server": "src/server.ts"
  }
}
```

```sh
npx rivet-cli deploy
```

Your endpoint is now TODO

Test it with TODO

</Tab>

<Tab title="Cloudflare Workers">
TODO
</Tab>

<Tab title="Redis">

```sh
npm install @rivetkit/redis
```

```ts server.ts
import { registry } from "./registry";
import { createRedisDriver } from "@rivetkit/redis";

// Start RivetKit
const { client, hono } = registry.run({
	driver: createRedisDriver({
		host: "127.0.0.1",
		port: 6379,
	}),
});

// ...rest of code...
```

</Tab>

<Tab title="File System">

```sh
npm install @rivetkit/file-system
```

```ts server.ts
import { registry } from "./registry";
import { createFileSystemDriver } from "@rivetkit/file-system";

// Start RivetKit
const { client, hono } = registry.run({
	driver: createFileSystemDriver(),
});

// ...rest of code...
```

</Tab>

</Tabs>

</Step>

</Steps>

## Configuration Options

### Connect your frontend to the Rivet Actor

TODO: Quick summary of why you would want to connect your frontend

Connect your frontend:

<CodeGroup>

```ts JavaScript
import { createClient } from "@rivetkit/actor/client";
import type { registry } from "./registry.js";

const client = createClient<typeof registry>("http://localhost:8080/registry");

const result = await client.myActor.getOrCreate().myAction("Hello, world!");
```

```ts React
import { useState } from "react";
import { createClient, createRivetKit } from "@@rivetkit/actor/react";
import type { registry } from "./registry";

const client = createClient<typeof registry>(`http://localhost:8080/registry`);
const { useActor } = createRivetKit(client);

function App() {
	const [count, setCount] = useState(0);
	const [counterName, setCounterName] = useState("test-counter");

	const counter = useActor({
		name: "counter",
		key: [counterName],
	});

	counter.useEvent("newCount", (x: number) => setCount(x));

	const increment = async () => {
		await counter.connection?.increment(1);
	};

	return (
		<div>
			<h1>Counter: {count}</h1>
			<input
				type="text"
				value={counterName}
				onChange={(e) => setCounterName(e.target.value)}
				placeholder="Counter name"
			/>
			<button onClick={increment}>Increment</button>
		</div>
	);
}
```

</CodeGroup>

TODO: Learn more under the XXXX docs

<Note>
	TODO: Link to onAuth docs
</Note>

<Note>
	TODO: Note that `/registry` must be exposed
</Note>

### Run as standalone server (no fetch handler)

TODO: Intro

```ts
import { registry } from "./registry";
import { Hono } from "hono";
import { serve } from "@hono/node-server";

// Start RivetKit
const { client, hono } = registry.run();

// Setup server
const app = new Hono();

// ...setup routes...

serve({ fetch: app.fetch, port: 8080 }, (x) =>
	console.log("Listening at http://localhost:8080"),
);
```

IMPORTANT: You'll need to do special stuff to support deploying to Rivet or Cloudflare Workers

## Next Steps

TODO

<CardGroup>
	<Card title="Overview" href="/concepts/overview" icon="square-plus" horizontal={true} />
	<Card title="Interacting with Actors" href="/concepts/interacting-with-actors" icon="square-plus" horizontal={true} />
	<Card title="Actions" href="/concepts/actions" icon="bolt" horizontal={true} />
	<Card title="State" href="/concepts/state" icon="floppy-disk" horizontal={true} />
</CardGroup>

